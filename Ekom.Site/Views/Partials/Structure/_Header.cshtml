@inherits Umbraco.Web.Mvc.UmbracoTemplatePage
@using Ekom.API;
@using Ekom.Site.Extensions.Services;

@{ 
    var currentStore = Store.Current.GetStore();
    var allStores = Store.Current.GetAllStores();
    var rootCategories = Catalog.Current.GetRootCategories();
    var order = Order.Current.GetOrder();
    var root = UmbracoService.GetRootNode(Model.Content);

    var checkoutNode = root.Children.FirstOrDefault(x => x.GetTemplateAlias() == "Checkout");
}

<header class="header @(Model.Content.Level == 1 || Model.Content.DocumentTypeAlias == "ekmProduct" ? "header--no-margin" : "")">

    <div class="header__top">
        <div class="grid-container">

            <div class="header__wrapper">

                <div class="header__left">

                    <div class="select select--light">

                        <span class="select__value">@currentStore.Title</span>

                        <ul class="select__dropdown">
                            @foreach (var store in allStores.Where(x => x.Id != currentStore.Id))
                            {
                                <li>
                                    <a href="#">@store.Title</a>
                                </li>
                            }
                        </ul>

                    </div>

                    <span class="header__divider"></span>

                    <div class="select select--light">

                        <span class="select__value">ISK</span>

                        <ul class="select__dropdown">
                            <li>
                                <a href="#">USD</a>
                            </li>
                        </ul>

                    </div>

                </div>

                <div class="header__right">
                   
                    <span class="header__divider"></span>

                    <a href="#" class="header__top__link">@Umbraco.GetDictionaryValue("HeMyAccount")</a>

                </div>

            </div>

        </div>
    </div>

    <div class="header__bottom">
        <div class="grid-container">
            <div class="header__wrapper header__wrapper--bottom">

                <div class="header__left">

                    <nav class="header__categories">
                        <ul>
                            @foreach (var category in rootCategories)
                            {
                                var selected = Array.IndexOf(Model.Content.Path.Split(','), category.Id.ToString()) >= 0 ? true : false;

                                <li class="@(selected ? "header__navItem--is-selected" : "")">
                                    <a href="@category.Url">@category.Title</a>
                                </li>

                            }
                        </ul>
                    </nav>

                </div>

                <div class="header__center">
                    
                    <div class="header__brand">
                        <a href="@currentStore.Url">Ekom</a>
                    </div>

                </div>

                <div class="header__right">
                    
                    <a href="@(checkoutNode != null ? checkoutNode.Url : "")" class="header__cart">
                        <span class="header__cart__text">Your cart:</span>
                        <span class="header__cart__qty">@(order != null ? order.Quantity : 0)</span>
                    </a>

                </div>

            </div>

        </div>
    </div>

</header>
